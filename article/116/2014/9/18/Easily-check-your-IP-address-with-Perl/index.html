<!DOCTYPE html>
<html lang="en-us">
  <head>
  <title> Easily check your IP address with Perl </title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="The WWW::curlmyip module is an API for curlmyip.com"/>
    <meta name="robots" content="index, follow">
    <link rel="icon" href="/favicon.ico">
    
</head>
<body>

<div class="container antonio">
  <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
      <ul id="follow-buttons" class="nav navbar-nav pull-right follow">
          <li>FOLLOW US:</li>
          <li><a href="https://twitter.com/intent/follow?screen_name=perltricks">
              <img src="/images/header/twitter_20.png" alt="twitter"></a><li>
          <li><a href="/index.xml" />
              <img src="/images/header/rss_20.png" alt="rss"></a></li>
          <li><a href="https://github.com/dnmfarrell/perltricks-static/" />
              <img src="/images/header/github_light_20.png" alt="GH"></a></li>
      </ul>
      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
          <a class="navbar-brand" href="/">
          <img src="/images/header/perltricks_logo.png" alt="PerlTricks" />
          </a>
      </div>
      <div class="navbar-collapse collapse">
        <ul class="nav navbar-nav">
          <li><a href="/">
              <div class="circle">
                  <span class="glyphicon glyphicon-home txt-perltricks-blue" aria-hidden="true"></span>
              </div>
                  &nbsp;&nbsp;HOME</a>
          </li>
          <li><a href="/authors">
              <div class="circle">
                  <span class="glyphicon glyphicon-pencil txt-perltricks-blue" aria-hidden="true"></span>
              </div>
                  &nbsp;&nbsp;AUTHORS</a>
          </li>
          <li><a href="/about">
              <div class="circle">
                  <span class="glyphicon glyphicon-user txt-perltricks-blue" aria-hidden="true"></span>
              </div>
                  &nbsp;&nbsp;ABOUT</a>
          </li>
        </ul>
      </div>
    </div>
  </div>
</div>
<div class="push"></div>


  <section id="content" role="main">
    <section class="entry-content">
      <div class="container">
        <div class="row">
          <div class="col-md-9">
            <div class="row">
              <article>
              
              
              <h1 class="blog-post-title">Easily check your IP address with Perl</h1>
              <p class="blog-post-meta">Sep 18, 2014 by <a href="#author-bio">David Farrell</a></p>
              <img alt="" src=""/>
                

<p>Every now and then I&rsquo;ll run into a problem where I need to programmatically check my IP address. Each time I&rsquo;ve hand-crafted a solution, which is fine, but good programming is DRY programming, and so I finally wrote a module to do it. The module is called <a href="https://metacpan.org/pod/WWW::curlmyip">WWW::curlmyip</a> because it uses the <a href="http://curlmyip.com">curlmyip.com</a> service. I find the module useful and you might too.</p>

<h3 id="core-perl-solution:cf26d793cfd057bc371af7c785bc0d25">Core Perl solution</h3>

<p>Before we look at the module, let&rsquo;s consider a Perl solution using only core Perl code. I can grab my IP address from the terminal with a single line of Perl:</p>

<pre><code class="language-prettyprint">$ perl -MHTTP::Tiny -e 'print HTTP::Tiny-&gt;new-&gt;get(q{http://curlmyip.com})-&gt;{content}'
121.45.140.5
</code></pre>

<p><strong>Tip:</strong> if you&rsquo;re on Windows use double quotes instead of singles.</p>

<p>Well that was easy. But notice how I didn&rsquo;t have to append a newline to the output? That&rsquo;s because curlmyip.com returns the IP address with a newline appended. If we want to use the IP address as an input to any other program, we&rsquo;ll need to <code>chomp</code> that newline away. The code would then be:</p>

<pre><code class="language-prettyprint">$ perl -MHTTP::Tiny -E '$ip=HTTP::Tiny-&gt;new-&gt;get(q{http://curlmyip.com})-&gt;{content}; chomp $ip; say $ip'
121.45.140.5
</code></pre>

<p>Not so clean anymore is it? In fact it would be a stretch to call this a &ldquo;one liner&rdquo; at all. What about if I wanted to add exception handling, to <code>die</code> and print a useful error message? Once you get to this stage, it&rsquo;s time to think about putting the code into a module.</p>

<h3 id="using-www-curlmyip:cf26d793cfd057bc371af7c785bc0d25">Using WWW::curlmyip</h3>

<p>The module exports a <code>get_ip</code> function which returns the IP address. It&rsquo;s super simple to use:</p>

<pre><code class="language-prettyprint">use WWW::curlmyip;

my $ip = get_ip();
</code></pre>

<p>So far, so good. But what can you do with this information? In the past I&rsquo;ve had programs check my IP address when connected to a VPN, or to TOR to confirm my real IP is masked. The other obvious use case is geolocation:</p>

<pre><code class="language-prettyprint">#!/usr/bin/env perl

use WWW::curlmyip;
use Geo::IP;

my $ip = get_ip();

my $geoip = Geo::IP-&gt;open('GeoLiteCity.dat', GEOIP_STANDARD);
my $record = $geoip-&gt;record_by_addr($ip);

print &quot;You are in $record-&gt;{region_name}, $record-&gt;{country_code}\n&quot;;
</code></pre>

<p>In this code I retrieve my IP address and then lookup my location using the <a href="https://metacpan.org/pod/Geo::IP">Geo::IP</a> module from MaxMind. Saving the code as <code>whereami.pl</code> and running it outputs:</p>

<pre><code class="language-prettyprint">$ whereami.pl
You are in New York, US
</code></pre>

<p>The geolocation data could also be used an an input to last week&rsquo;s weather <a href="http://perltricks.com/article/114/2014/9/11/Get-a-weather-report-at-the-terminal-with-Perl">script</a> to automatically retrieve the weather forecast for your local area.</p>

<h3 id="conclusion:cf26d793cfd057bc371af7c785bc0d25">Conclusion</h3>

<p>It&rsquo;s a simple task but hopefully WWW::curlmyip makes obtaining your IP address a little easier. If your interested in Geo::IP, check out Gabor Szabo&rsquo;s recent <a href="http://perlmaven.com/using-travis-ci-and-installing-geo-ip-on-linux#h2">guide</a> on how to install it. Finally, if you want to get your IP address and location in a single request, take a look at my other new module, <a href="https://metacpan.org/pod/WWW::ipinfo">WWW::ipinfo</a>.</p>

              </article>
              <p><strong>Tags</strong></p>
              <div class="tags">
                <div class="category"><a href="/categories/web">web</a></div>
                
                  <div class="tag"><a href="/tags/ip">ip</a></div>
                
                  <div class="tag"><a href="/tags/address">address</a></div>
                
                  <div class="tag"><a href="/tags/ipinfo">ipinfo</a></div>
                
                  <div class="tag"><a href="/tags/curlmyip">curlmyip</a></div>
                
                  <div class="tag"><a href="/tags/geo_ip">geo_ip</a></div>
                
                  <div class="tag"><a href="/tags/geolocate">geolocate</a></div>
                
                  <div class="tag"><a href="/tags/maxmind">maxmind</a></div>
                
                  <div class="tag"><a href="/tags/old_site">old_site</a></div>
                
              </div>
            </div>
            <div class="row" id="author-bio">
              
              <div class="col-sm-2">
                <div class="circle-avatar" style="background-image:url(/images/author/david.jpg)"></div>
              </div>
              <div class="col-sm-10">
                <h3>David Farrell</h3>
                <p>David is the founder and editor of PerlTricks.com. An organizer of the <a href="http://www.meetup.com/The-New-York-Perl-Meetup-Group/">New York Perl Meetup</a>, he works as a technology consultant in New York City.</p>
                <h5><a href="/authors/david-farrell">Browse their articles</a></h5>
              </div>
            </div>
            <div class="push"></div>
          </div>
          <div class="col-md-3">
            <div class="latest-sidebar">

  <div class="row">
    <div class="col-sm-12 centering">
      <span style="font-size:1.8em" class="antonio txt-perltricks-blue">OUR LATEST ARTICLES</span>
    </div>
  </div>
  
        
        
  <div class="row">
      <a href="http://perltricks.com/article/displaying-the-git-branch-in-the-terminal-prompt-with-perl/">
    <div class="col-sm-3">
      <div class="circle-avatar" style="background-image:url(/images/displaying-the-git-branch-in-the-terminal-prompt-with-perl/Git-Logo-1788C.png)"></div>
    </div>
    <div class="col-sm-9">
        <h6>Displaying the Git branch in the terminal prompt with and without Perl</h6>
        <p style="line-height:1"><small>Where am I again? No more typing &#34;git branch&#34;</small></p>
    </div>
      </a>
  </div>
  
        
        
  <div class="row">
      <a href="http://perltricks.com/article/april_fools/">
    <div class="col-sm-3">
      <div class="circle-avatar" style="background-image:url(/images/author/brian.jpg)"></div>
    </div>
    <div class="col-sm-9">
        <h6>Perl Jam VI: April Trolls</h6>
        <p style="line-height:1"><small>Perl&#39;s ignored security problems, j/k but srsly this time</small></p>
    </div>
      </a>
  </div>
  
        
        
  <div class="row">
      <a href="http://perltricks.com/article/what-s-new-on-cpan---April-2016/">
    <div class="col-sm-3">
      <div class="circle-avatar" style="background-image:url(/images/168/81C6F1B4-DCE9-11E4-86D9-23646037288D.png)"></div>
    </div>
    <div class="col-sm-9">
        <h6>What&#39;s new on CPAN - April 2016</h6>
        <p style="line-height:1"><small>A curated look at April&#39;s new CPAN uploads</small></p>
    </div>
      </a>
  </div>
  
        
        
  <div class="row">
      <a href="http://perltricks.com/article/fixing-a-sluggish-linux-after-suspend-resume/">
    <div class="col-sm-3">
      <div class="circle-avatar" style="background-image:url(/images/author/david.jpg)"></div>
    </div>
    <div class="col-sm-9">
        <h6>Fixing a sluggish Linux after suspend-resume</h6>
        <p style="line-height:1"><small>The cpupower program can resolve throttled machines</small></p>
    </div>
      </a>
  </div>
  
        
        
  <div class="row">
      <a href="http://perltricks.com/article/how-to-parse-binary-data-with-perl/">
    <div class="col-sm-3">
      <div class="circle-avatar" style="background-image:url(/images/how-to-parse-binary-data-with-perl/hackers_internet.jpg)"></div>
    </div>
    <div class="col-sm-9">
        <h6>How to parse binary data with Perl</h6>
        <p style="line-height:1"><small>Parsing binary data is easy with unpack</small></p>
    </div>
      </a>
  </div>
  
</div>

            <div class="row" style="margin-top:20px">
  <div class="col-sm-12 centering">
    <a class="twitter-timeline" data-dnt="true" href="https://twitter.com/PerlTricks" data-widget-id="618973837762383879">Tweets by @PerlTricks</a>
    <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
  </div>
</div>

            <div class="row" style="margin-top:20px">
  <div class="col-sm-12 centering">
    <script src="/widgets/toplinks/toplinks.js" type="text/javascript"></script>
    <div id="toplinks"></div>
  </div>
</div>

            </div>
          </div>
        </div>
      </div>
    </section>
  </section>
<script>
 
var tables, i;
tables = document.getElementsByTagName('table');
for (i=0;i<tables.length;i++) {
  tables[i].className = 'table table-striped';
}
</script>
<div class="push"></div>
<div class="footer">
  <div class="container">
    <div class="row">
      <div class="col-md-1">
        <h5>Site Map</h5>
        <ul>
        <li><a href="/about">About</a></li>
        <hr>
        <li><a href="/">Articles</a></li>
        <hr>
        <li><a href="/authors">Authors</a></li>
        <hr>
        </ul>
      </div>
      <div class="col-md-4">
        <h5>Contact Us</h5>
        <p>To get in touch, send an email to: editor@perltricks.com</p>
        <p>Follow us:&nbsp;
          <a href="https://twitter.com/intent/follow?screen_name=perltricks">
              <img src="/images/footer/twitter_20_dark.png" alt="twitter"></a>
          <a href="/index.xml" /><img src="/images/footer/rss_20_dark.png" alt="rss"></a>
          <a href="https://github.com/dnmfarrell/perltricks-static/" />
              <img src="/images/header/github_light_20.png" alt="GH"></a></p>
          <p>&copy; <span id="year"></span> PerlTricks.com</p>
      </div>
      <div class="col-md-7">
          <h5>Legal</h5>
          <p>PerlTricks.com and the authors make no representations or warranties with respect to the accuracy or completeness of the contents of all work on this website and specifically disclaim all warranties, including without limitation warranties of fitness for a particular purpose. No warranty may be created or extended. The advice and strategies published on this website may not be suitable for every situation. All work on this website is provided with the understanding that PerlTricks.com and the authors are not engaged in rendering legal, accounting, or other professional services. Neither PerlTricks.com nor the authors shall be liable for damages arising herefrom.</p>
      </div>
    </div>
  </div>
</div>
<link href="/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" type="text/css" href="/css/perltricks.css"/>
<script src="/javascript/jquery.min.js"></script>
<script src="/javascript/bootstrap.min.js"></script>
<script src="/javascript/prettify.min.js"></script>
<script>document.getElementById("year").innerHTML = (new Date()).getFullYear();prettyPrint();</script>
</body>
</html>

