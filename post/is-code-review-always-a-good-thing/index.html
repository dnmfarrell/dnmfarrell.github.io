<!DOCTYPE html>
<html>
  <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Is Code Review Always A Good Thing?</title>
  <meta name="description" content="Not all changes are equally risky" />
  <link rel="stylesheet" href="/assets/css/style.css" type="text/css">
  <meta property="twitter:card" content="summary">
  <meta property="twitter:site" content="@perltricks">
  <meta property="og:url" content="https://blog.dnmfarrell.com/post/is-code-review-always-a-good-thing/" />
  <meta property="og:title" content="Is Code Review Always A Good Thing?" />
  <meta property="og:description" content="Not all changes are equally risky">
  <meta property="og:site_name" content="blog.dnmfarrell.com" />
  <meta property="og:type" content="article" />
  <meta property="og:article:published_time" content="2021-09-05T28:43:21Z" />
  <meta property="og:article:tag" content="code-quality" />
  <meta property="og:article:tag" content="code-review" />
  <meta property="og:article:tag" content="change-control" />
  <meta property="og:article:tag" content="tradeoffs" />
</head>

  <body>
    <a href="/">
  <h1>Code Matters</h1>
</a>

    <main>
      

<h2>Is Code Review Always A Good Thing?</h2>

<em>September 5, 2021</em>

<p>Code review is one of those hygienic things most developers believe they ought to do, like kitchen workers washing their hands, but don&rsquo;t always do. Yet tech articles tend to be unanimously in favor of code review, extolling its benefits (&ldquo;catch bugs&rdquo;, &ldquo;maintain code consistency&rdquo;, &ldquo;transfer knowledge&rdquo;). So if restaurants can require workers to wash their hands, maybe organizations can require their developers to review every code change?</p>
<p>Broadly speaking I think we can lump all of code review&rsquo;s benefits under the category of &ldquo;improve code quality&rdquo;. I know there is no agreed-upon definition of code quality but allow me to channel my inner <a href="https://en.wikipedia.org/wiki/I_know_it_when_I_see_it">Justice Potter</a> and wave away your objections for now. (What of &ldquo;transfer knowledge&rdquo;? - first I think unfamiliar reviewers reviewing code changes is <a href="https://gigamonkeys.com/code-reading/">inefficient</a> compared to them interacting with the code by making a small change and/or writing tests for it. Second whatever knowledge is accumulated by the reviewer should ultimately lead to higher quality code output anyway).</p>
<h2 id="context">Context</h2>
<p>Do you think every code change to a life-support system should be reviewed? What about code that just controls adverts? Does your assessment change if the advertising code is being burned directly onto silicon chips which control billboards?</p>
<p>Code review happens in a context. It is more valuable in high risk/severity contexts than otherwise. If you require your developers to review every code change, the stakes should be high, else they will know it&rsquo;s bullshit and the process will become a &ldquo;LGTM&rdquo; parade. Mandating code review might make it <em>more</em> likely for bugs to sneak through, especially when there is a deluge of changes to be reviewed. A 2018 <a href="https://dl.acm.org/doi/10.1145/3183519.3183525">study</a> of Google&rsquo;s mandatory code review practices included this nugget:</p>
<blockquote>
<p>The majority of changes are small, have one reviewer and no comments other than the authorization to commit</p>
</blockquote>
<p>The study also reported that 70% of changes are approved within 24 hours. Now, a favorable interpretation would be that the code change submissions are of such high quality that they are quickly approved without comment, but I think understanding human nature suggests otherwise.</p>
<p>Returning to knowledge transfer for a moment, a <a href="https://dl.acm.org/doi/10.1145/3387904.3389270">study</a> of over 32,000 code-reviewed changes on GitHub found no evidence that the submitters' code quality increased in subsequent code changes. This suggests to me that the open source volunteer context degrades submission quality as the consequences are low compared to being an employee, but also that knowledge transfer is a complex process and perhaps not strongly associated with code review alone, but a supportive learning environment.</p>
<h2 id="change-risk">Change Risk</h2>
<p>Even if the organizational and system contexts are the same, not all code changes are equally risky. You can probably guess the <a href="https://dl.acm.org/doi/10.5555/2820518.2820538">important factors</a>:</p>
<ul>
<li>Submitter <a href="https://dl.acm.org/doi/10.1145/3387904.3389270">familiarity</a> with the codebase and general level of <a href="https://dl.acm.org/doi/10.1145/2168556.2168642">experience</a></li>
<li>Number of <a href="https://dl.acm.org/doi/10.1109/ICSE.2009.5070510">files/lines of code changed</a></li>
<li>Code <a href="https://dl.acm.org/doi/10.1145/2025113.2025121">complexity</a></li>
<li>Does the code have a clear, single <a href="https://dl.acm.org/doi/10.1145/2025113.2025119">owner</a> who is responsible for its performance?</li>
<li>Does the change have tests, does the codebase have good <a href="https://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.212.6713&amp;rep=rep1&amp;type=pdf">test code coverage</a></li>
</ul>
<p>Organizations can use this knowledge to use code review when it&rsquo;s most valuable. It could be as simple as only reviewing code submissions from newbies (some <a href="https://dl.acm.org/doi/10.1145/2597073.2597082">Open Source projects do this</a>), to as complex as building a system which flags higher risk changes for review. Obviously such a system based on hard metrics would be imperfect and flag too few/many changes for review. That would still be better than blanket mandatory code review and the system&rsquo;s tolerance could be tuned to the needs of the organization. Using AI to predict bugs in code changes is an active research area which will yield more intelligent vetting behavior (imagine a change containing hundreds of the same one word substitution; it probably doesn&rsquo;t need a review).</p>
<p>Despite the limitations of our understanding of code quality, keeping in mind the context and nature of a code change can help us decide when the opportunity cost of code review is worthwhile.</p>


<p>


<em>Tags: 



  
  
  

  <a href=https://blog.dnmfarrell.com/tags/code-quality/>code-quality</a>



  
  
  

  <a href=https://blog.dnmfarrell.com/tags/code-review/>code-review</a>



  
  
  

  <a href=https://blog.dnmfarrell.com/tags/change-control/>change-control</a>



  
  
  

  <a href=https://blog.dnmfarrell.com/tags/tradeoffs/>tradeoffs</a>



</em>



</p>


    </main>
    <footer>
    <p>Follow me on Twitter <a href="https://twitter.com/PerlTricks">@perltricks</a></p>
 </footer>

  </body>
</html>
